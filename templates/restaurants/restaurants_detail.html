{% extends 'base.html' %}

{% block content %}
    {% include "mixins/address_display.html" %}

    <div id="contents">
        <div class="flex px-64 py-2 mb-3 border-b border-gray-500">
            <ul class="flex justify-between items-center w-2/3">
                <li v-for="group in groups" v-if="group.id != 1">
                    <div class="border-b-2 border-white hover:border-black">
                        <a v-bind:href="'../../groups/' + group.id" class="px-2">
                            <span class="text-black cursor-pointer">[[group.name]]</span>
                        </a>
                    </div>
                </li>
            </ul>
            <div class="flex justify-end w-1/3 h-full">
                <input v-on:keyup.enter="search_restaurants()" v-model:trim="name" class="p-0 pl-2 w-3/4 h-8 text-sm" type="text" placeholder="음식점 또는 메뉴로 검색" disabled/>
            </div>
        </div>
        
        
        <span v-for="restaurant in restaurant">
            [[restaurant.name]]
        </span>

        <span v-for="menu in menus">
            [[menu.name]]
        </span>
        
        
            
    </div>
    
</div>
{% endblock content %}

{% block javascript %}

<script>
    // CSRF Token 관련하여 전역변수로 선언
    axios.defaults.xsrfCookieName = 'csrftoken';
    axios.defaults.xsrfHeaderName = 'X-CSRFToken';

    var vm = new Vue({
        delimiters: ["[[", "]]"],
        el: "#contents",
        data: {
            groups: [],
            restaurant: [],
            menus: [],
            restaurants_id: "{{restaurants_id}}",
        },
        created: function () {
            console.log("created()");
            this.fetch_all_groups();
            this.fetch_restaurant();
            this.fetch_menus();
        },
        methods: {
            fetch_all_groups: function () {
                var vm = this;

                axios.get("/api/groups-bar/")
                    .then(function (res) {
                        console.log("res.data", res.data);
                        vm.groups = res.data;
                        
                    })
                    .catch(function (err) {
                        console.log("GET ERR", err);
                    })
            },
            fetch_restaurant: function () {
                var vm = this;

                axios.get("/api/{{restaurant_id}}/restaurant-detail-api/")
                    .then(function (res) {
                        console.log("restaurant", res.data);
                        vm.restaurant = res.data;
                        
                    })
                    .catch(function (err) {
                        console.log("GET ERR", err);
                    })
            },
            fetch_menus: function () {
                var vm = this;

                axios.get("/api/{{restaurant_id}}/menus-list-api/")
                    .then(function (res) {
                        console.log("menus", res.data);
                        vm.menus = res.data;
                        
                    })
                    .catch(function (err) {
                        console.log("GET ERR", err);
                    })
            },
        },
    })
</script>
{% endblock javascript %}